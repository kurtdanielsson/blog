(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{380:function(a,t,e){"use strict";e.r(t);var s=e(40),r=Object(s.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"setting-up-linux-raid-partitions-using-mdadm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-linux-raid-partitions-using-mdadm"}},[a._v("#")]),a._v(" Setting up Linux Raid partitions using MDADM")]),a._v(" "),e("p",[a._v("I just wantet to set up my disks in a Raid configuration, so I had to start reading up on it.")]),a._v(" "),e("h2",{attrs:{id:"status-commands"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#status-commands"}},[a._v("#")]),a._v(" Status Commands")]),a._v(" "),e("p",[a._v("Scan active raids")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mdadm --detail --scan \n")])])]),e("p",[a._v("Generate mdadm.conf")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mdadm --detail --scan | sudo tee -a /etc/mdadm/mdadm.conf\n")])])]),e("p",[a._v("Find active arrays")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cat /proc/mdstat\n")])])]),e("p",[a._v("Show raid status")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mdadm -D /dev/md0\n")])])]),e("p",[a._v("Scan partition for raids")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mdadm -E /dev/sdXY\n")])])]),e("h2",{attrs:{id:"delete-raid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#delete-raid"}},[a._v("#")]),a._v(" Delete RAID")]),a._v(" "),e("p",[a._v("First, unmount")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("umount /dev/md0\n")])])]),e("p",[a._v("Stop and remove")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mdadm --stop /dev/md0\nmdadm --remove /dev/md0\n")])])]),e("h2",{attrs:{id:"create-raid-1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create-raid-1"}},[a._v("#")]),a._v(" Create RAID 1")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mdadm --create --verbose /dev/md0 --level=1 --raid-devices=2 /dev/sda1 /dev/sdc1\n")])])]),e("h2",{attrs:{id:"general"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#general"}},[a._v("#")]),a._v(" General")]),a._v(" "),e("p",[a._v("When raid "),e("code",[a._v("/dev/md0")]),a._v(" is created, make filesystem")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mkfs.ext4 -F /dev/md0\n")])])]),e("p",[a._v("Create mount point")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mkdir -p /mnt/md0\n")])])]),e("p",[a._v("Mount raid")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mount /dev/md0 /mnt/md0\n")])])]),e("p",[a._v("Check that raid is mounted")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("df -h -x devtmpfs -x tmpfs\n")])])]),e("p",[a._v("Mount raid at boot, insert into "),e("code",[a._v("/etc/fstab")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("/dev/md0 /mnt/md0 ext4 defaults,nofail,discard 0 0\n")])])]),e("p",[a._v("Assemble existing linux_raid_member in new raid keeping data")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mdadm --assemble --run /dev/md1 /dev/sda1\n")])])]),e("h2",{attrs:{id:"making-a-clean-install-of-linux"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#making-a-clean-install-of-linux"}},[a._v("#")]),a._v(" Making a clean install of Linux")]),a._v(" "),e("p",[a._v("I made a clean install of the system disk, leaving my two mdadm-created raid disks as they where, and when the new install of Ubuntu Server was completed, the Raid Array was showing up without any extra commands or anything. It worked perfectly.")]),a._v(" "),e("h2",{attrs:{id:"mdadm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mdadm"}},[a._v("#")]),a._v(" MDADM")]),a._v(" "),e("ul",[e("li",[a._v("Check out my videos about setting up RAID 1 with mdadm in Linux.")])]),a._v(" "),e("iframe",{attrs:{width:"560",height:"315",src:"https://www.youtube.com/embed/yvakkoCBa5E",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}})])}),[],!1,null,null,null);t.default=r.exports}}]);